{% extends "::base.html.twig" %}

{% block title %}Гостьова книга{% endblock %}

{% block content %}
    <form action='' method="post" class="form-signin">
    {{ form_label(form.name)}} {{ form_widget(form.name)}} {{ form_errors(form.name) }}
    {{ form_label(form.email)}}{{ form_widget(form.email) }} {{ form_errors(form.email) }}
    {{ form_label(form.message)}}{{ form_widget(form.message) }} {{ form_errors(form.message) }}
    {{ form_widget(form.ok) }}
    {{ form_rest(form) }}
    {{ form_errors(form) }}
    </form>
{% if pagination.haveToPaginate %}
    {{ pagerfanta(pagination) }}
{% endif %}
       <div id="updates">
{% for post in pagination.currentPageResults %}
            <div class="thumbnail">
                <div class="when-added">добавлено: {{ post.dateTimeUploaded.date }} </div>
                <div class="caption">
                    <h4>Відгук від {{ post.name }} ({{post.email}})</h4>
                    <p>{{ post.message | dotdotdot(100)}} </p>
                </div>
                    <a href=' {{path('_postview',{'id':post.id}) }}'>просмотреть</a>
                    <a href=' {{path('_postdelete',{'id':post.id}) }}'> удалить </a>
            </div>
{% endfor %}
{% if nextpage is not null %}
<div id="more{{nextpage}}" class="morebox">
<a href="#" class="more" id="{{nextpage}}">more</a>
</div>
{% endif %}

        </div>
{% endblock %}

    {% block javascripts %}
        {% javascripts '@jquery_js' '@bootstrap_js' filter='?yui_js' combine=true %}
        <script src="{{ asset_url }}"></script>
        {% endjavascripts %}

        <script type="text/javascript">
$(function() {
//More Button
$('.more').on("click",function() {
    var ID = $('.more').attr("id");
    if(ID)
    {
        $("#more"+ID).html('<img src="/web/acmedemo/images/spinner3-genuine.gif" />');
        $.ajax({
            type: "POST",
            url: "/posts_pager/-1/"+ ID,
            data: "lastmsg="+ ID, 
            cache: false,
            success: function(html){
                $("#updates").append(html);
                $("#more"+ID).remove();
            }
        });
    }
    else {
    $(".morebox").html('The End');
    }
return false;
});
});

</script>

    {% endblock javascripts %}


{% set code = code(_self) %}

